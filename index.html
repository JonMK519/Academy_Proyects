<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Case Analyzer Pro - Professional Financial Analysis Tool</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
</head>
<body>
    <!-- Header with Language Toggle -->
    <header>
        <div class="header-container">
            <div class="header-brand">
                <h1 id="header-title">Business Case Analyzer Pro</h1>
                <p id="header-subtitle">Professional Financial Analysis & ROI Calculator</p>
            </div>
            <div class="language-toggle">
                <button class="active" onclick="switchLanguage('en')" id="lang-en">English</button>
                <button onclick="switchLanguage('es')" id="lang-es">Espa√±ol</button>
            </div>
        </div>
    </header>

    <main>
        <!-- STEP 1: Strategic Module -->
        <div id="step1-strategic-module" style="display: block;">
            <section>
                <h2 id="section-strategic">Strategic Analysis</h2>
                <p id="strategic-description" style="color: var(--text-muted); margin-bottom: 2rem;">
                    Start by defining the strategic foundation of your business case. Our AI will analyze the viability and provide insights.
                </p>
                
                <form id="strategicForm">
                    <div class="form-group">
                        <label for="stratProjectName">
                            <span id="label-stratProjectName">Project Name</span> *
                            <span class="help-icon" onclick="showGuideModal('projectName')" title="Click for detailed guidance">üí°</span>
                        </label>
                        <input type="text" id="stratProjectName" placeholder="e.g., AI-Powered Customer Support Automation" required>
                        <div class="field-quality" id="quality-stratProjectName"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="problemOpportunity">
                            <span id="label-problemOpportunity">Problem/Opportunity Identified</span> *
                            <span class="help-icon" onclick="showGuideModal('problemOpportunity')" title="Click for detailed guidance">üí°</span>
                        </label>
                        <textarea id="problemOpportunity" rows="4" placeholder="e.g., Our support team spends 10 hours/week manually classifying tickets, causing 4-hour delays and 15% customer dissatisfaction..." required></textarea>
                        <div class="field-quality" id="quality-problemOpportunity"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="proposedSolution">
                            <span id="label-proposedSolution">Proposed Solution (with or without AI)</span> *
                            <span class="help-icon" onclick="showGuideModal('proposedSolution')" title="Click for detailed guidance">üí°</span>
                        </label>
                        <textarea id="proposedSolution" rows="4" placeholder="e.g., Implement an AI triage agent for instant ticket classification. Phase 1: Auto-categorization and priority assessment. Out of scope: Automated responses..." required></textarea>
                        <div class="field-quality" id="quality-proposedSolution"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="successMetrics">
                            <span id="label-successMetrics">Success Metrics / ROI</span> *
                            <span class="help-icon" onclick="showGuideModal('successMetrics')" title="Click for detailed guidance">üí°</span>
                        </label>
                        <textarea id="successMetrics" rows="3" placeholder="e.g., Reduce classification time by 90% in Q1 (10h to 1h/week), decrease first response time by 50%, improve satisfaction by 5 points..." required></textarea>
                        <div class="field-quality" id="quality-successMetrics"></div>
                    </div>
                    
                    <!-- Overall Progress Indicator -->
                    <div class="progress-indicator">
                        <div class="progress-header">
                            <span id="progress-title">Business Case Quality Score</span>
                            <span class="progress-score" id="overall-score">0/100</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill" style="width: 0%;"></div>
                        </div>
                        <div class="progress-checklist" id="progress-checklist"></div>
                    </div>
                    
                    <div class="button-group">
                        <button type="submit" class="btn-primary" id="btn-generate-analysis">
                            Generate Analysis
                        </button>
                    </div>
                </form>
                
                <div id="strategicAnalysisResult" class="strategic-result hidden">
                    <h3 id="analysis-title">Strategic Analysis Result</h3>
                    <div class="analysis-content" id="analysisContent">
                        <!-- Analysis will be displayed here -->
                    </div>
                    <div class="button-group">
                        <button type="button" class="btn-primary" onclick="goToStep2()" id="btn-continue-financial">
                            Continue to Financial Projection
                        </button>
                    </div>
                </div>
            </section>
        </div>

        <!-- STEP 2: Financial Calculator Module -->
        <div id="step2-financial-module" style="display: none;">
            <!-- Back Button -->
            <div style="margin-bottom: 2rem;">
                <button type="button" class="btn-secondary" onclick="goToStep1()" id="btn-back-step1">
                    ‚Üê Back to Strategic Analysis
                </button>
            </div>

            <!-- Dashboard with Key Metrics -->
            <section>
                <h2 id="section-dashboard">Financial Dashboard</h2>
                <div class="dashboard" id="dashboard">
                    <div class="metric-card success">
                        <div class="metric-label" id="metric-label-roi">ROI (Return on Investment)</div>
                        <div class="metric-value" id="roi-value">0%</div>
                        <div class="metric-change" id="roi-status">Enter data to calculate</div>
                    </div>
                    <div class="metric-card info">
                        <div class="metric-label" id="metric-label-npv">NPV (Net Present Value)</div>
                        <div class="metric-value" id="npv-value">$0</div>
                        <div class="metric-change" id="npv-status">Discounted cash flow</div>
                    </div>
                    <div class="metric-card warning">
                        <div class="metric-label" id="metric-label-payback">Payback Period</div>
                        <div class="metric-value" id="payback-value">0</div>
                        <div class="metric-change" id="payback-status">months to recover investment</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label" id="metric-label-irr">IRR (Internal Rate of Return)</div>
                        <div class="metric-value" id="irr-value">0%</div>
                        <div class="metric-change" id="irr-status">Annualized return rate</div>
                    </div>
                </div>
            </section>

            <!-- Project Data Entry Form -->
        <section>
            <h2 id="section-project-info">Project Information</h2>
            <form id="projectForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="projectName">Nombre del Proyecto *</label>
                        <input type="text" id="projectName" placeholder="ej., Transformaci√≥n Digital" required>
                    </div>
                    <div class="form-group">
                        <label for="initialInvestment">Inversi√≥n Inicial ($) *</label>
                        <input type="number" id="initialInvestment" placeholder="100000" min="0" step="1000" required>
                    </div>
                    <div class="form-group">
                        <label for="discountRate">Tasa de Descuento (%) * <span class="tooltip-icon" title="Tasa utilizada para descontar flujos futuros al valor presente">‚ÑπÔ∏è</span></label>
                        <input type="number" id="discountRate" placeholder="10" min="0" max="100" step="0.1" value="10" required>
                    </div>
                    <div class="form-group">
                        <label for="projectDuration">Duraci√≥n del Proyecto (meses) *</label>
                        <input type="number" id="projectDuration" placeholder="24" min="1" max="120" value="24" required>
                    </div>
                </div>

                <h3 id="subsection-revenue">Revenue Projections</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="yearlyRevenue">Incremento de Ingresos Anuales ($) * <span class="tooltip-icon" title="Aumento esperado en ingresos cada a√±o">‚ÑπÔ∏è</span></label>
                        <input type="number" id="yearlyRevenue" placeholder="50000" min="0" step="1000" required>
                    </div>
                    <div class="form-group">
                        <label for="revenueGrowth">Tasa de Crecimiento de Ingresos (% anual) <span class="tooltip-icon" title="Porcentaje de crecimiento anual de ingresos">‚ÑπÔ∏è</span></label>
                        <input type="number" id="revenueGrowth" placeholder="5" min="0" max="100" step="0.1" value="0">
                    </div>
                </div>

                <h3 id="subsection-costs">Cost Projections</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="operatingCosts">Costos Operativos Anuales ($) <span class="tooltip-icon" title="Gastos recurrentes de operaci√≥n">‚ÑπÔ∏è</span></label>
                        <input type="number" id="operatingCosts" placeholder="20000" min="0" step="1000" value="0">
                    </div>
                    <div class="form-group">
                        <label for="maintenanceCosts">Costos de Mantenimiento Anuales ($) <span class="tooltip-icon" title="Gastos anuales de mantenimiento">‚ÑπÔ∏è</span></label>
                        <input type="number" id="maintenanceCosts" placeholder="5000" min="0" step="1000" value="0">
                    </div>
                </div>

                <h3 id="subsection-scenarios">Scenario Analysis</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="bestCaseMultiplier">Multiplicador Mejor Caso <span class="tooltip-icon" title="Factor optimista para escenarios favorables">‚ÑπÔ∏è</span></label>
                        <input type="number" id="bestCaseMultiplier" placeholder="1.3" min="1" max="3" step="0.1" value="1.3">
                    </div>
                    <div class="form-group">
                        <label for="worstCaseMultiplier">Multiplicador Peor Caso <span class="tooltip-icon" title="Factor pesimista para escenarios adversos">‚ÑπÔ∏è</span></label>
                        <input type="number" id="worstCaseMultiplier" placeholder="0.7" min="0.1" max="1" step="0.1" value="0.7">
                    </div>
                </div>

                <div class="button-group">
                    <button type="submit" class="btn-primary" id="btn-calculate">
                        Calculate Analysis
                    </button>
                    <button type="button" class="btn-secondary" onclick="resetForm()" id="btn-reset">
                        Reset Form
                    </button>
                </div>
            </form>
            <div id="formMessage" class="hidden"></div>
        </section>

        <!-- Charts Section with Tabs -->
        <section>
            <h2 id="section-visual-analysis">Visual Analysis</h2>
            <div class="tabs">
                <button class="tab active" onclick="switchTab('cashflow')">Flujo de Caja en el Tiempo</button>
                <button class="tab" onclick="switchTab('roi')">Comparaci√≥n de ROI</button>
                <button class="tab" onclick="switchTab('scenarios')">An√°lisis de Escenarios</button>
            </div>

            <div id="cashflow-tab" class="tab-content active">
                <div class="chart-container">
                    <canvas id="cashflowChart"></canvas>
                </div>
            </div>

            <div id="roi-tab" class="tab-content">
                <div class="chart-container">
                    <canvas id="roiChart"></canvas>
                </div>
            </div>

            <div id="scenarios-tab" class="tab-content">
                <div class="chart-container">
                    <canvas id="scenariosChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Scenario Comparison Cards -->
        <section>
            <h2 id="section-scenarios">Scenario Comparison</h2>
            <div class="scenario-grid" id="scenarioGrid">
                <div class="scenario-card expected">
                    <div class="scenario-title" id="title-expected">üìä Expected Case</div>
                    <div class="scenario-metrics">
                        <div class="scenario-metric">
                            <span id="label-expected-roi">ROI:</span>
                            <strong id="expected-roi">0%</strong>
                        </div>
                        <div class="scenario-metric">
                            <span id="label-expected-npv">NPV:</span>
                            <strong id="expected-npv">$0</strong>
                        </div>
                        <div class="scenario-metric">
                            <span id="label-expected-payback">Payback:</span>
                            <strong id="expected-payback">0 months</strong>
                        </div>
                    </div>
                </div>

                <div class="scenario-card best">
                    <div class="scenario-title" id="title-best">üöÄ Best Case</div>
                    <div class="scenario-metrics">
                        <div class="scenario-metric">
                            <span id="label-best-roi">ROI:</span>
                            <strong id="best-roi">0%</strong>
                        </div>
                        <div class="scenario-metric">
                            <span id="label-best-npv">NPV:</span>
                            <strong id="best-npv">$0</strong>
                        </div>
                        <div class="scenario-metric">
                            <span id="label-best-payback">Payback:</span>
                            <strong id="best-payback">0 months</strong>
                        </div>
                    </div>
                </div>

                <div class="scenario-card worst">
                    <div class="scenario-title" id="title-worst">‚ö†Ô∏è Worst Case</div>
                    <div class="scenario-metrics">
                        <div class="scenario-metric">
                            <span id="label-worst-roi">ROI:</span>
                            <strong id="worst-roi">0%</strong>
                        </div>
                        <div class="scenario-metric">
                            <span id="label-worst-npv">NPV:</span>
                            <strong id="worst-npv">$0</strong>
                        </div>
                        <div class="scenario-metric">
                            <span id="label-worst-payback">Payback:</span>
                            <strong id="worst-payback">0 months</strong>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Smart Recommendations -->
        <section>
            <h2 id="section-recommendations">Smart Recommendations</h2>
            <div class="recommendations" id="recommendations">
                <p style="color: #718096;">Complete el formulario y calcule para recibir recomendaciones inteligentes basadas en su an√°lisis de caso de negocio.</p>
            </div>
        </section>

            <!-- Export Options -->
            <section class="text-center">
                <h2 id="section-export">Export Report</h2>
                <p id="export-description" style="color: var(--text-muted); margin-bottom: 20px;">Generate a comprehensive PDF report with all metrics, charts and recommendations.</p>
                <button class="btn-export" onclick="exportToPDF()" id="btn-export">
                    Export Full Report to PDF
                </button>
            </section>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner"></div>
    </div>

    <!-- Guide Modal -->
    <div id="guideModal" class="modal hidden">
        <div class="modal-content">
            <span class="modal-close" onclick="closeGuideModal()">&times;</span>
            <h3 class="modal-title" id="modal-title"></h3>
            <div class="modal-body" id="modal-body"></div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>